# 教师智能助手系统 - 开发需求文档

## 一、项目概述

### 1.1 项目背景
教师智能助手系统是一个基于前后端分离架构的教学管理平台，旨在帮助教师高效完成资料整理、课堂考勤、成绩分析等日常教学管理任务，并通过智能算法提升工作效率。

### 1.2 技术架构
- **前端**: Vue 3 + TypeScript + Vite + Element Plus + Pinia + Vue Router
- **后端**: Flask + Flask-SQLAlchemy + Flask-JWT-Extended + Flask-CORS
- **数据库**: MySQL / SQLite
- **智能模块**: NumPy, Pandas, Scikit-learn, OpenCV, Jieba
- **版本控制**: Git (Gitee/Gitcode)
- **容器化**: Docker + Docker Compose (可选)

---

## 二、系统功能模块

### 2.1 基础模块(必须实现)

#### 2.1.1 用户认证与权限管理

**功能描述**:
- 多角色用户系统(教师、学生、管理员)
- 用户注册、登录、登出
- 基于JWT的身份认证
- 基于角色的权限控制(RBAC)

**技术实现**:
- 后端: Flask-JWT-Extended实现JWT认证
- 密码加密: Werkzeug的generate_password_hash
- 权限装饰器: 自定义权限验证装饰器

**数据模型**:
```python
User:
  - id: 主键
  - username: 用户名
  - user_code: 工号/学号(唯一)
  - password_hash: 密码哈希
  - email: 邮箱(唯一)
  - phone: 手机号
  - real_name: 真实姓名
  - avatar: 头像URL
  - role: 角色(admin/teacher/student)
  - class_id: 班级ID(学生角色时使用)
  - status: 账号状态(1:正常, 0:禁用)
  - create_time: 创建时间
  - update_time: 更新时间
  - last_login_time: 最后登录时间
```

**API接口**:
- POST /api/auth/register - 用户注册
- POST /api/auth/login - 用户登录
- POST /api/auth/logout - 用户登出
- GET /api/auth/get_loginuser - 获取当前登录用户信息
- PUT /api/auth/update_profile - 更新用户信息
- POST /api/auth/change-password - 修改密码

---

#### 2.1.2 资料中心

**功能描述**:
- 文件上传/下载
- 在线预览(支持PDF、图片、Office文档)
- 按课程/标签分类管理
- 全文搜索功能
- 文件夹层级结构

**技术实现**:
- 文件存储: 本地文件系统或云存储(OSS)
- 文件预览: 前端使用pdf.js、docx-preview等库
- 搜索: 基于数据库的模糊查询或Elasticsearch全文搜索

**数据模型**:
```python
Material:
  - id: 主键
  - title: 资料标题
  - description: 资料描述
  - file_name: 原始文件名
  - file_path: 文件存储路径
  - file_size: 文件大小(字节)
  - file_type: 文件类型(pdf/doc/ppt/xlsx等)
  - course_id: 关联课程ID
  - uploader_id: 上传者ID
  - category_id: 分类ID
  - download_count: 下载次数
  - view_count: 浏览次数
  - keywords: 关键词(逗号分隔,用于智能归类)
  - auto_classified: 是否自动分类(1:是, 0:否)
  - create_time: 上传时间
  - update_time: 更新时间

MaterialCategory:
  - id: 主键
  - name: 分类名称
  - parent_id: 父分类ID(NULL表示顶级分类)
  - description: 分类描述
  - sort_order: 排序序号
  - create_time: 创建时间
  - update_time: 更新时间

MaterialTag:
  - id: 主键
  - name: 标签名称
  - usage_count: 使用次数
  - create_time: 创建时间
  - update_time: 更新时间

Course:
  - id: 主键
  - name: 课程名称
  - code: 课程代码(唯一)
  - description: 课程描述
  - teacher_id: 授课教师ID
  - semester: 学期(如:2024-2025-1)
  - academic_year: 学年(如:2024-2025)
  - credit: 学分
  - total_hours: 总学时
  - status: 课程状态(1:进行中, 0:已结束)
  - create_time: 创建时间
  - update_time: 更新时间

Class:
  - id: 主键
  - name: 班级名称(如:计算机2024-1班)
  - code: 班级代码(唯一)
  - grade: 年级(如:2024级)
  - major: 专业
  - department: 院系
  - class_teacher_id: 班主任ID
  - student_count: 学生人数
  - enrollment_year: 入学年份
  - status: 状态(1:在读, 0:已毕业)
  - create_time: 创建时间
  - update_time: 更新时间
```

**API接口**:
- POST /api/materials/upload - 上传文件
- GET /api/materials - 获取资料列表(支持分页、筛选)
- GET /api/materials/{id} - 获取资料详情
- GET /api/materials/{id}/download - 下载文件
- PUT /api/materials/{id} - 更新资料信息
- DELETE /api/materials/{id} - 删除资料
- GET /api/materials/search - 搜索资料
- GET /api/courses - 获取课程列表
- POST /api/courses - 创建课程

---

#### 2.1.3 课堂考勤

**功能描述**:
- 教师创建考勤任务
- 生成签到二维码
- 学生扫码签到或手动确认
- 考勤记录查询与统计
- 考勤报表导出

**技术实现**:
- 二维码生成: qrcode库(Python)
- 二维码扫描: jsQR或html5-qrcode(前端)
- 实时更新: WebSocket或轮询

**数据模型**:
```python
Attendance:
  - id: 主键
  - course_id: 课程ID
  - class_id: 班级ID(可选,用于指定班级考勤)
  - teacher_id: 教师ID
  - title: 考勤标题
  - attendance_type: 考勤方式(qrcode/manual/face)
  - qr_code: 二维码token
  - start_time: 开始时间
  - end_time: 结束时间
  - location: 考勤地点
  - require_location: 是否需要位置验证
  - status: 状态(pending/active/ended)
  - create_time: 创建时间
  - update_time: 更新时间

AttendanceRecord:
  - id: 主键
  - attendance_id: 考勤任务ID
  - student_id: 学生ID
  - status: 出勤状态(present/late/absent/leave)
  - check_in_time: 签到时间
  - check_in_method: 签到方式(qrcode/manual/face/location)
  - latitude: 签到纬度
  - longitude: 签到经度
  - face_image_path: 人脸识别照片路径
  - remark: 备注
  - create_time: 创建时间
  - update_time: 更新时间

AttendanceStatistics:
  - id: 主键
  - course_id: 课程ID
  - student_id: 学生ID
  - total_count: 总考勤次数
  - present_count: 出勤次数
  - late_count: 迟到次数
  - absent_count: 缺勤次数
  - leave_count: 请假次数
  - attendance_rate: 出勤率(%)
  - create_time: 创建时间
  - update_time: 更新时间
```

**API接口**:
- POST /api/attendance - 创建考勤任务
- GET /api/attendance - 获取考勤列表
- GET /api/attendance/{id} - 获取考勤详情
- POST /api/attendance/{id}/check-in - 学生签到
- PUT /api/attendance/{id}/close - 关闭考勤
- GET /api/attendance/{id}/records - 获取考勤记录
- GET /api/attendance/{id}/statistics - 获取考勤统计
- GET /api/attendance/{id}/export - 导出考勤记录

---

#### 2.1.4 成绩管理

**功能描述**:
- 成绩录入(单条录入、Excel批量导入)
- 成绩查询与修改
- 统计分析(平均分、最高/最低分、标准差)
- 可视化图表(分数段分布、趋势图)
- 成绩报表导出

**技术实现**:
- Excel处理: pandas + openpyxl
- 统计计算: NumPy + Pandas
- 图表生成: 前端使用ECharts或Chart.js

**数据模型**:
```python
Grade:
  - id: 主键
  - course_id: 课程ID
  - student_id: 学生ID
  - exam_type: 考试类型(daily/midterm/final/homework)
  - exam_name: 考试名称
  - score: 分数
  - full_score: 满分
  - weight: 权重(用于计算总评)
  - exam_date: 考试日期
  - remark: 备注
  - create_time: 录入时间
  - update_time: 更新时间

GradeStatistics:
  - id: 主键
  - course_id: 课程ID
  - exam_type: 考试类型
  - exam_name: 考试名称
  - total_students: 总人数
  - average_score: 平均分
  - highest_score: 最高分
  - lowest_score: 最低分
  - std_deviation: 标准差
  - median_score: 中位数
  - pass_rate: 及格率(%)
  - excellent_rate: 优秀率(%)
  - score_distribution: 分数段分布(JSON格式)
  - create_time: 创建时间
  - update_time: 更新时间
```

**API接口**:
- POST /api/grades - 录入单条成绩
- POST /api/grades/batch-import - Excel批量导入
- GET /api/grades - 获取成绩列表
- GET /api/grades/{id} - 获取成绩详情
- PUT /api/grades/{id} - 更新成绩
- DELETE /api/grades/{id} - 删除成绩
- GET /api/grades/statistics - 获取统计数据
- GET /api/grades/distribution - 获取分数段分布
- GET /api/grades/export - 导出成绩报表
- GET /api/grades/template - 下载导入模板

---

#### 2.1.5 课堂互动

**功能描述**:
- 实时投票
- 在线提问与回答
- 弹幕互动
- 课堂讨论区

**技术实现**:
- 实时通信: Flask-SocketIO + Socket.io(前端)
- 消息队列: Redis(可选)

**数据模型**:
```python
Poll:
  - id: 主键
  - course_id: 课程ID
  - teacher_id: 教师ID
  - title: 投票标题
  - description: 投票描述
  - poll_type: 投票类型(single/multiple)
  - options: 选项(JSON数组)
  - is_anonymous: 是否匿名(1:是, 0:否)
  - start_time: 开始时间
  - end_time: 结束时间
  - status: 状态(active/ended)
  - create_time: 创建时间
  - update_time: 更新时间

PollResponse:
  - id: 主键
  - poll_id: 投票ID
  - student_id: 学生ID
  - selected_options: 选中的选项(JSON数组)
  - create_time: 投票时间
  - update_time: 更新时间

Question:
  - id: 主键
  - course_id: 课程ID
  - user_id: 提问者ID
  - content: 问题内容
  - is_anonymous: 是否匿名(1:是, 0:否)
  - status: 状态(pending/answered)
  - like_count: 点赞数
  - create_time: 创建时间
  - update_time: 更新时间

QuestionAnswer:
  - id: 主键
  - question_id: 问题ID
  - user_id: 回答者ID
  - content: 回答内容
  - is_accepted: 是否被采纳(1:是, 0:否)
  - like_count: 点赞数
  - create_time: 创建时间
  - update_time: 更新时间

Barrage:
  - id: 主键
  - course_id: 课程ID
  - user_id: 用户ID
  - content: 弹幕内容
  - is_anonymous: 是否匿名(1:是, 0:否)
  - status: 状态(1:正常, 0:已删除)
  - create_time: 创建时间
  - update_time: 更新时间
```

**API接口**:
- POST /api/polls - 创建投票
- GET /api/polls - 获取投票列表
- POST /api/polls/{id}/vote - 投票
- GET /api/polls/{id}/results - 获取投票结果
- POST /api/questions - 提问
- GET /api/questions - 获取问题列表
- POST /api/questions/{id}/answer - 回答问题
- WebSocket /socket.io - 实时弹幕和互动

---

### 2.2 智能模块(至少实现2项)

#### 2.2.1 自动化资料归类

**功能描述**:
- 文档内容提取与分析
- 关键词自动提取
- 文本分类与智能归类
- 自动标签推荐

**技术实现**:
- 中文分词: Jieba
- 关键词提取: TF-IDF算法或TextRank
- 文本分类: Scikit-learn (朴素贝叶斯、SVM等)
- 文档解析: PyPDF2(PDF)、python-docx(Word)

**实现步骤**:
1. 文档上传时提取文本内容
2. 使用Jieba进行中文分词
3. 使用TF-IDF提取关键词
4. 基于关键词和预训练分类模型进行分类
5. 返回推荐的分类和标签

**数据模型**:
```python
DocumentKeyword:
  - id: 主键
  - material_id: 资料ID
  - keyword: 关键词
  - weight: 权重/重要性(0-1)
  - extraction_method: 提取方法(TF-IDF/TextRank/BERT等)
  - create_time: 创建时间
  - update_time: 更新时间

ClassificationLog:
  - id: 主键
  - material_id: 资料ID
  - original_category_id: 原分类ID
  - suggested_category_id: 建议分类ID
  - confidence: 置信度(0-1)
  - is_accepted: 是否接受建议(1:是, 0:否, NULL:待处理)
  - algorithm_used: 使用的算法(NaiveBayes/SVM/BERT等)
  - features: 特征数据(JSON格式)
  - create_time: 创建时间
  - update_time: 更新时间
```

**API接口**:
- POST /api/ai/classify-material - 分析并分类资料
- GET /api/ai/keywords/{material_id} - 获取关键词
- POST /api/ai/suggest-tags - 获取标签建议

**代码示例**:
```python
import jieba
import jieba.analyse
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.naive_bayes import MultinomialNB

def extract_keywords(text, topK=10):
    """提取关键词"""
    keywords = jieba.analyse.extract_tags(text, topK=topK, withWeight=True)
    return keywords

def classify_document(text, model, vectorizer):
    """文档分类"""
    # 分词
    words = jieba.cut(text)
    text_processed = ' '.join(words)
    
    # 向量化
    X = vectorizer.transform([text_processed])
    
    # 预测
    category = model.predict(X)[0]
    probability = model.predict_proba(X)[0]
    
    return category, max(probability)
```

---

#### 2.2.2 学情预警与预测

**功能描述**:
- 基于历史成绩的趋势分析
- 学生成绩预测
- 挂科风险预警
- 个性化学习建议

**技术实现**:
- 数据处理: Pandas + NumPy
- 机器学习: Scikit-learn (线性回归、随机森林等)
- 特征工程: 平均分、标准差、出勤率、作业完成率等

**实现步骤**:
1. 收集学生历史成绩、考勤、作业等数据
2. 特征工程: 构建特征向量
3. 训练预测模型(线性回归、随机森林等)
4. 预测下次考试成绩
5. 设置预警阈值,标记高风险学生

**数据模型**:
```python
GradePrediction:
  - id: 主键
  - student_id: 学生ID
  - course_id: 课程ID
  - predicted_score: 预测分数
  - confidence: 置信度(0-1)
  - risk_level: 风险等级(low/medium/high)
  - is_warning: 是否预警(1:是, 0:否)
  - prediction_date: 预测日期
  - model_version: 模型版本
  - features_used: 使用的特征(JSON格式)
  - recommendation: 改进建议
  - create_time: 创建时间
  - update_time: 更新时间

Notification:
  - id: 主键
  - user_id: 接收者ID
  - type: 通知类型(system/attendance/grade/warning)
  - title: 通知标题
  - content: 通知内容
  - link: 跳转链接
  - is_read: 是否已读(1:是, 0:否)
  - priority: 优先级(0:普通, 1:重要, 2:紧急)
  - create_time: 创建时间
  - update_time: 更新时间
```

**API接口**:
- POST /api/ai/predict-grade - 预测学生成绩
- GET /api/ai/warnings - 获取预警列表
- GET /api/ai/student-analysis/{student_id} - 学生学情分析
- POST /api/ai/train-model - 训练预测模型(管理员)

**代码示例**:
```python
import pandas as pd
import numpy as np
from sklearn.linear_model import LinearRegression
from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split

def prepare_features(student_data):
    """准备特征"""
    features = {
        'avg_score': student_data['grades'].mean(),
        'score_trend': calculate_trend(student_data['grades']),
        'attendance_rate': student_data['attendance_count'] / student_data['total_classes'],
        'assignment_rate': student_data['completed_assignments'] / student_data['total_assignments'],
        'std_dev': student_data['grades'].std(),
    }
    return pd.DataFrame([features])

def predict_grade(student_id, course_id, model):
    """预测成绩"""
    # 获取学生数据
    student_data = get_student_data(student_id, course_id)
    
    # 准备特征
    X = prepare_features(student_data)
    
    # 预测
    predicted_score = model.predict(X)[0]
    
    # 风险评估
    risk_level = 'high' if predicted_score < 60 else 'medium' if predicted_score < 75 else 'low'
    
    return {
        'predicted_score': predicted_score,
        'risk_level': risk_level,
        'confidence': calculate_confidence(X, model)
    }

def train_prediction_model(course_id):
    """训练预测模型"""
    # 获取历史数据
    data = get_historical_data(course_id)
    
    # 准备特征和标签
    X = prepare_features_batch(data)
    y = data['final_score']
    
    # 划分训练集和测试集
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)
    
    # 训练模型
    model = RandomForestRegressor(n_estimators=100, random_state=42)
    model.fit(X_train, y_train)
    
    # 评估
    score = model.score(X_test, y_test)
    
    return model, score
```

---

#### 2.2.3 人脸识别签到(可选)

**功能描述**:
- 人脸录入与管理
- 人脸识别签到
- 拍照自动统计人数

**技术实现**:
- 人脸检测: OpenCV + Haar Cascade或dlib
- 人脸识别: face_recognition库
- 图像处理: OpenCV

**数据模型**:
```python
FaceData:
  - id: 主键
  - student_id: 学生ID
  - face_encoding: 人脸编码(二进制)
  - image_path: 照片路径
  - created_at: 录入时间
```

**API接口**:
- POST /api/face/register - 录入人脸
- POST /api/face/recognize - 人脸识别签到
- POST /api/face/count - 拍照统计人数

---

#### 2.2.4 智能问答助手(可选)

**功能描述**:
- 基于课程资料的智能问答
- 常见问题自动回答
- 学习建议推荐

**技术实现**:
- NLP: NLTK或简单的规则匹配
- 向量检索: 基于TF-IDF的相似度匹配
- 深度学习: PyTorch + 预训练模型(如BERT)(可选)

---

## 三、数据库设计

### 3.1 核心表结构

#### 用户相关
- users - 用户表
- roles - 角色表(可选)
- permissions - 权限表(可选)

#### 课程相关
- courses - 课程表
- course_students - 课程学生关联表

#### 资料相关
- materials - 资料表
- material_tags - 标签表
- material_categories - 分类表

#### 考勤相关
- attendances - 考勤任务表
- attendance_records - 考勤记录表

#### 成绩相关
- grades - 成绩表
- grade_statistics - 成绩统计表

#### 互动相关
- polls - 投票表
- poll_votes - 投票记录表
- questions - 问题表
- answers - 回答表
- barrages - 弹幕表

#### 智能模块相关
- material_classifications - 资料分类记录表
- student_predictions - 学生预测表
- student_warnings - 学生预警表
- face_data - 人脸数据表(可选)

### 3.2 数据库关系图

```
users (1) ----< (N) courses (教师创建的课程)
users (N) ----< (N) courses (学生选修的课程) [通过course_students]
courses (1) ----< (N) materials
courses (1) ----< (N) attendances
courses (1) ----< (N) grades
attendances (1) ----< (N) attendance_records
materials (1) ----< (1) material_classifications
users (1) ----< (N) student_predictions
users (1) ----< (N) student_warnings
```

---

## 四、前端开发规范

### 4.1 项目结构
```
frontend/
├── src/
│   ├── api/           # API接口封装
│   ├── assets/        # 静态资源
│   ├── components/    # 公共组件
│   ├── views/         # 页面组件
│   ├── router/        # 路由配置
│   ├── stores/        # Pinia状态管理
│   ├── utils/         # 工具函数
│   ├── types/         # TypeScript类型定义
│   ├── App.vue        # 根组件
│   └── main.ts        # 入口文件
├── public/            # 公共资源
└── package.json       # 依赖配置
```

### 4.2 核心页面

#### 公共页面
- Login.vue - 登录页
- Register.vue - 注册页
- Dashboard.vue - 仪表盘

#### 教师端页面
- TeacherHome.vue - 教师首页
- CourseManage.vue - 课程管理
- MaterialManage.vue - 资料管理
- AttendanceManage.vue - 考勤管理
- GradeManage.vue - 成绩管理
- ClassInteraction.vue - 课堂互动
- StudentAnalysis.vue - 学情分析

#### 学生端页面
- StudentHome.vue - 学生首页
- MyCourses.vue - 我的课程
- MaterialCenter.vue - 资料中心
- MyAttendance.vue - 我的考勤
- MyGrades.vue - 我的成绩
- ClassRoom.vue - 课堂互动

### 4.3 状态管理(Pinia)

```typescript
// stores/user.ts
export const useUserStore = defineStore('user', {
  state: () => ({
    token: '',
    userInfo: null,
    role: ''
  }),
  actions: {
    login(credentials) { },
    logout() { },
    fetchUserInfo() { }
  }
})

// stores/course.ts
export const useCourseStore = defineStore('course', {
  state: () => ({
    currentCourse: null,
    courseList: []
  })
})
```

### 4.4 API封装

```typescript
// api/auth.ts
export const authAPI = {
  login: (data: LoginForm) => request.post('/auth/login', data),
  register: (data: RegisterForm) => request.post('/auth/register', data),
  logout: () => request.post('/auth/logout'),
  getLoginUser: () => request.get('/auth/get_loginuser')
}

// api/material.ts
export const materialAPI = {
  upload: (file: File) => request.post('/materials/upload', formData),
  getList: (params: any) => request.get('/materials', { params }),
  download: (id: number) => request.get(`/materials/${id}/download`)
}
```

---

## 五、后端开发规范

### 5.1 项目结构
```
backend/
├── app/
│   ├── api/           # API路由
│   ├── models/        # 数据模型
│   ├── schemas/       # Pydantic模式
│   ├── services/      # 业务逻辑
│   ├── utils/         # 工具函数
│   ├── exceptions/    # 自定义异常
│   ├── middleware/    # 中间件
│   ├── extensions.py  # Flask扩展初始化
│   └── __init__.py    # 应用工厂
├── migrations/        # 数据库迁移
├── tests/             # 测试文件
├── config.py          # 配置文件
├── requirements.txt   # 依赖列表
└── run.py             # 启动文件
```

### 5.2 API设计规范

#### RESTful规范
- GET /api/resource - 获取资源列表
- GET /api/resource/{id} - 获取单个资源
- POST /api/resource - 创建资源
- PUT /api/resource/{id} - 更新资源
- DELETE /api/resource/{id} - 删除资源

#### 响应格式
```json
{
  "code": 200,
  "message": "success",
  "data": { }
}
```

#### 错误响应
```json
{
  "code": 400,
  "message": "错误信息",
  "errors": { }
}
```

### 5.3 认证与权限

```python
# 装饰器示例
from functools import wraps
from flask_jwt_extended import get_jwt_identity, verify_jwt_in_request

def role_required(role):
    def decorator(fn):
        @wraps(fn)
        def wrapper(*args, **kwargs):
            verify_jwt_in_request()
            user_id = get_jwt_identity()
            user = User.query.get(user_id)
            if user.role != role:
                return {'message': '权限不足'}, 403
            return fn(*args, **kwargs)
        return wrapper
    return decorator

# 使用
@api.route('/teacher-only')
@role_required('teacher')
def teacher_only():
    return {'message': '教师专属接口'}
```

---

## 六、开发流程与规范

### 6.1 Git工作流

#### 分支管理
- main/master - 主分支(生产环境)
- develop - 开发分支
- feature/* - 功能分支
- bugfix/* - 修复分支
- release/* - 发布分支

#### 提交规范
```
feat: 新功能
fix: 修复bug
docs: 文档更新
style: 代码格式调整
refactor: 重构
test: 测试相关
chore: 构建/工具链相关

示例:
feat: 添加考勤签到功能
fix: 修复成绩导入bug
docs: 更新API文档
```

### 6.2 开发步骤

1. **需求分析** - 明确功能需求和技术方案
2. **数据库设计** - 设计表结构和关系
3. **API设计** - 定义接口规范
4. **后端开发** - 实现业务逻辑
5. **前端开发** - 实现用户界面
6. **联调测试** - 前后端联调
7. **功能测试** - 完整功能测试
8. **代码审查** - Code Review
9. **部署上线** - 部署到服务器

### 6.3 测试规范

#### 后端测试
```python
# tests/test_auth.py
def test_login():
    response = client.post('/api/auth/login', json={
        'username': 'test',
        'password': 'password'
    })
    assert response.status_code == 200
    assert 'token' in response.json['data']
```

#### 前端测试
- 单元测试: Vitest
- E2E测试: Cypress或Playwright

---

## 七、部署方案

### 7.1 Docker部署

#### Dockerfile (后端)
```dockerfile
FROM python:3.10-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
CMD ["python", "run.py"]
```

#### Dockerfile (前端)
```dockerfile
FROM node:18-alpine as build
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=build /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/conf.d/default.conf
```

#### docker-compose.yml
```yaml
version: '3.8'
services:
  backend:
    build: ./backend
    ports:
      - "5000:5000"
    environment:
      - DATABASE_URL=mysql://user:pass@db:3306/eduinsight
    depends_on:
      - db
  
  frontend:
    build: ./frontend
    ports:
      - "80:80"
    depends_on:
      - backend
  
  db:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: rootpass
      MYSQL_DATABASE: eduinsight
    volumes:
      - db_data:/var/lib/mysql

volumes:
  db_data:
```

### 7.2 传统部署

#### 后端部署
1. 安装Python环境和依赖
2. 配置数据库连接
3. 运行数据库迁移
4. 使用Gunicorn + Nginx部署

```bash
gunicorn -w 4 -b 0.0.0.0:5000 run:app
```

#### 前端部署
1. 构建生产版本: `npm run build`
2. 将dist目录部署到Nginx
3. 配置Nginx反向代理

---

## 八、开发时间规划

### 第1-2周: 项目初始化与基础功能
- 项目环境搭建
- 数据库设计与创建
- 用户认证模块
- 基础UI框架搭建

### 第3-4周: 核心功能开发
- 资料中心模块
- 课程管理模块
- 考勤管理模块

### 第5-6周: 成绩与互动功能
- 成绩管理模块
- 课堂互动模块
- 数据可视化

### 第7-8周: 智能模块开发
- 资料自动归类
- 学情预警与预测
- 模型训练与优化

### 第9-10周: 测试与优化
- 功能测试
- 性能优化
- Bug修复
- 文档完善

### 第11-12周: 部署与答辩准备
- 系统部署
- 演示准备
- 答辩PPT制作

---

## 九、技术难点与解决方案

### 9.1 文件上传与存储
**难点**: 大文件上传、断点续传
**方案**: 
- 使用分片上传
- 前端使用WebUploader或类似库
- 后端使用临时目录合并分片

### 9.2 实时通信
**难点**: WebSocket连接管理、消息同步
**方案**:
- 使用Flask-SocketIO
- Redis作为消息代理
- 房间机制管理不同课程的连接

### 9.3 成绩数据可视化
**难点**: 大量数据的图表渲染
**方案**:
- 使用ECharts按需加载
- 后端进行数据聚合
- 前端实现虚拟滚动

### 9.4 智能模型训练
**难点**: 训练数据不足、模型准确率
**方案**:
- 使用模拟数据进行训练
- 采用简单但有效的模型(线性回归、朴素贝叶斯)
- 定期更新模型

### 9.5 权限控制
**难点**: 细粒度权限管理
**方案**:
- 基于角色的访问控制(RBAC)
- 前端路由守卫
- 后端装饰器验证

---

## 十、参考资源

### 官方文档
- Vue 3: https://cn.vuejs.org/
- Flask: https://flask.palletsprojects.com/
- Element Plus: https://element-plus.org/
- Scikit-learn: https://scikit-learn.org/

### 学习资源
- Flask Mega-Tutorial
- Vue 3 + TypeScript 实战
- Python机器学习实战

### 开源项目参考
- vue-element-admin (前端管理系统模板)
- Flask-RESTful-API (后端API模板)

---

## 十一、团队协作建议

### 11.1 角色分工
- **前端开发** (1-2人): 负责Vue页面开发、组件封装
- **后端开发** (1-2人): 负责Flask API开发、数据库设计
- **算法开发** (1人): 负责智能模块开发、模型训练
- **测试/运维** (1人): 负责测试、部署、文档编写

### 11.2 沟通机制
- 每周例会: 同步进度、讨论问题
- 代码审查: 提交前互相Review
- 文档更新: 及时更新API文档和开发文档
- Issue管理: 使用Git Issue跟踪任务和Bug

### 11.3 质量保证
- 代码规范: 使用ESLint(前端)、Flake8(后端)
- 单元测试: 核心功能必须有测试覆盖
- 集成测试: 定期进行前后端联调测试
- 性能测试: 关注接口响应时间和并发能力

---

## 十二、注意事项

1. **数据安全**: 
   - 密码必须加密存储
   - 敏感信息不得明文传输
   - 实现SQL注入防护

2. **异常处理**:
   - 所有API必须有异常处理
   - 返回友好的错误信息
   - 记录详细的错误日志

3. **性能优化**:
   - 数据库查询优化(索引、分页)
   - 静态资源CDN加速
   - 接口响应缓存

4. **用户体验**:
   - 加载状态提示
   - 操作反馈(成功/失败提示)
   - 响应式设计(适配移动端)

5. **代码质量**:
   - 遵循代码规范
   - 适当的注释
   - 函数职责单一
   - 避免代码重复

---

## 附录

### A. 常用命令

#### 前端
```bash
npm install          # 安装依赖
npm run dev          # 开发模式
npm run build        # 生产构建
npm run lint         # 代码检查
```

#### 后端
```bash
pip install -r requirements.txt  # 安装依赖
flask db init                     # 初始化迁移
flask db migrate                  # 生成迁移
flask db upgrade                  # 执行迁移
python run.py                     # 启动服务
```

### B. 环境变量配置

#### .env (后端)
```
FLASK_APP=run.py
FLASK_ENV=development
SECRET_KEY=your-secret-key
DATABASE_URL=mysql://user:pass@localhost/eduinsight
JWT_SECRET_KEY=your-jwt-secret
```

#### .env (前端)
```
VITE_API_BASE_URL=http://localhost:5000/api
VITE_SOCKET_URL=http://localhost:5000
```
